{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport function getImagesByQuery(query, page = 1) {\n    const params = {\n        key: \"51362272-d48daa27a05223f6096b84303\",\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page,\n        per_page: 15,\n    };\n\n     return axios.get(\"https://pixabay.com/api/\", { params })\n        .then(response =>  response.data)\n        .catch(err => {\n            console.log(err);\n             throw err;\n        });\n}\n\n","// Описаний в документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryContainer = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a', { \n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n});\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('.load-more-button');\n\nexport function createGallery(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n    `\n    <li class=\"gallery-item\">\n      <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n      </a>\n      <div class=\"info\">\n        <p>Likes: ${likes}</p>\n        <p>Views: ${views}</p>\n        <p>Comments: ${comments}</p>\n        <p>Downloads: ${downloads}</p>\n      </div>\n    </li>\n    `\n    ).join('');\n    galleryContainer.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\n\n\nexport function clearGallery() {\n    galleryContainer.innerHTML = \"\";\n }\nexport function showLoader() {\n    loader.classList.remove('is-hidden');\n }\nexport function hideLoader() {\n    loader.classList.add('is-hidden');\n }\n\nexport function showLoadMoreButton() {\n    loadMoreBtn.classList.remove('is-hidden');\n}\nexport function hideLoadMoreButton() {\n    loadMoreBtn.classList.add('is-hidden');\n}","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from '../src/js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from '../src/js/render-functions';\n\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more-button');\nlet currentPage = 1;\nlet currentQuery = '';\nhideLoadMoreButton();\nlet totalPages = 0;\nconst onFormSubmit = async event => {\n   \n    event.preventDefault();\n    clearGallery();\n    hideLoadMoreButton();\n\n    const query = event.currentTarget.elements['search-text'].value.trim();\n    if (query === '') {\n        iziToast.info({\n            message: 'Insert the search request.'\n        })\n        return;\n    }\n\n    currentQuery = query;\n    currentPage = 1;\n    try {\n        showLoader();\n\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        totalPages = Math.ceil(data.totalHits / 15);\n    \n        if (data.hits.length === 0) {\n            iziToast.info({\n                message: `Sorry, there are no images matching your search query. Please try again!`,\n            });\n            hideLoadMoreButton();\n            return;\n        }\n    \n        createGallery(data.hits);\n        if (currentPage < totalPages) {\n \n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n        }\n    \n    } catch (err) {\n        iziToast.error({ message: `Error: ${err.message}` });\n    } finally {\n        hideLoader();\n    }\n};\n\nconst onLoadMoreBtnClick = async () => {\n    currentPage += 1; \n    showLoader();\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        createGallery(data.hits);\n        const galleryItem = document.querySelector('.gallery-item');\n        if (galleryItem) {\n            const { height } = galleryItem.getBoundingClientRect();\n            window.scrollBy({\n                top: height * 2,\n                behavior: \"smooth\",\n            });\n        }\n\n        if (currentPage >= totalPages) {\n            hideLoadMoreButton();\n             return iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\"\n    });\n        } else {\n            showLoadMoreButton();\n        }\n    } catch (err) {\n       iziToast.error({ message: `Error: ${err.message}` });\n    } finally {\n        hideLoader();\n    }\n};\n\n\nform.addEventListener('submit', onFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);"],"names":["getImagesByQuery","query","page","params","axios","response","err","galleryContainer","lightbox","SimpleLightbox","loader","loadMoreBtn","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","currentPage","currentQuery","totalPages","onFormSubmit","event","iziToast","data","onLoadMoreBtnClick","galleryItem","height"],"mappings":"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"}